\documentclass[a4paper]{article}

%use the english line for english reports
%usepackage[english]{babel}
\usepackage[portuguese]{babel}
\usepackage[utf8]{inputenc}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{verbatim}


\begin{document}

\setlength{\textwidth}{16cm}
\setlength{\textheight}{22cm}

\title{\Huge\textbf{Breakthru}\linebreak\linebreak\linebreak
\Large\textbf{Relatório Final}\linebreak\linebreak
\linebreak\linebreak
\includegraphics[scale=0.1]{feup-logo.png}\linebreak\linebreak
\linebreak\linebreak
\Large{Mestrado Integrado em Engenharia Informática e Computação} \linebreak\linebreak
\Large{Programação em Lógica}\linebreak
}

\author{\textbf{Grupo Breakthru 2:}\\
João Rafael de Figueiredo Cabral - 201304395 \\
João Bernardo Martins de Sousa e Silva Mota - 201303462 \\
\linebreak\linebreak \\
 \\ Faculdade de Engenharia da Universidade do Porto \\ Rua Roberto Frias, s\/n, 4200-465 Porto, Portugal \linebreak\linebreak\linebreak
\linebreak\linebreak\vspace{1cm}}

\maketitle
\thispagestyle{empty}

\section{Resumo}
No contexto da unidade curricular Programação em Lógica do MIEIC foi solicitada a implementação de um jogo de tabuleiro a ser selecionado pelo grupo.

Para a implementação deste jogo o grupo mobilizou os seus conhecimentos acerca de PROLOG e das capacidades generativas que o mesmo proporciona e que se revelaram de elevada importância para permitir o desenvolvimento de um jogo do ponto de vista declarativo, tornando-se apenas necessário explicitar em PROLOG as regras de funcionamento do jogo.

O acima exposto evidencia a acentuada diferença paradigmática da programação nesta linguagem, que representou para o grupo um desafio mas também uma oportunidade de adquirir destreza mental no que à programação em lógica diz respeito.



\tableofcontents
\newpage

\section{Introdução}
Foi proposta a implementação do jogo \textit{Breakthru} em PROLOG com uma interface textual e com a possibilidade de ser jogado em três modos diversos: humano contra humano, humano contra máquina e máquina contra máquina. Foi solicitado que o mecanismo de jogo da máquina apresentasse dois níveis distintos de dificuldade.

O presente relatório principia por apresentar o jogo desenvolvido, o seu contexto histórico e as regras que o regem. De seguida são apresentadas as principais estruturações programáticas do mesmo, do ponto de vista do modelo de dados usado e dos predicados lógicos fundamentais da implementação desenvolvida. Em particular é apresentada a representação interna do estado do jogo, os predicados usados para apresentar externamente essa mesma representação, bem como diversos predicados e restante lógica de movimentação de peças que permita verificar o cumprimento das regras por parte dos jogadores humanos e a escolha de jogadas por parte do computador, quando em controlo de um dos jogadores. São depois tecidas considerações sobre a interface com o utilizador e suas funcionalidades e implementação.

Encerra-se o relatório com uma breve reflexão sobre o trabalho desenvolvido, suas limitações e aspetos que ficam em aberto para eventuais futuras melhorias.

\section{O Jogo Breakthru}
O \emph{Breakthru} é um jogo de estratégia abstrata para dois jogadores em que cada lado começa com um número diferente de peças, colocadas em posições assimétricas e com objetivos diferentes para assegurar a vitória.

\subsection{História}
O jogo foi criado em 1965 por Alex Randolph, com um conjunto de regras baseadas nas do \emph{Hnefatafl}\footnote{https://boardgamegeek.com/boardgame/335/breakthru}, um jogo de estratégia abstrata cuja popularidade remonta à Escandinávia medieval, existindo vestígios da sua presença entre várias civilizações antigas\footnote{https://boardgamegeek.com/boardgame/2932/hnefatafl}.
\

\subsection{Regras}
\subsubsection{Peças}
A cor de cada jogador é sorteada através do lançamento de uma moeda, sendo que o jogador vencedor desse sorteio é o jogador dourado e o perdedor é o jogador prateado. O tabuleiro conta com 13 peças douradas, das quais 12 dispostas em quadrado à volta da 13ª peça, no centro do tabuleiro, e de 20 peças prateadas dispostas em volta das peças douradas.

O jogador dourado dispõe as suas 12 peças normais como desejar na zona central do tabuleiro, nele delimitada. O jogador prateado procede de forma semelhante, dispondo contudo as suas 20 peças fora da zona central, reservada ao jogador dourado.

Uma das peças douradas é diferente das restantes, sendo designada por navio almirante. A sua posição inicial é fixa, sendo obrigatório que seja colocada no centro do tabuleiro.

\subsubsection{Movimentos e Capturas}
Cada jogador deve, na sua vez, efetuar dois movimentos ou uma captura. O jogador dourado escolhe quem deve jogar primeiro.

Todas as peças podem ser movimentadas um número arbitrário de espaços livres na horizontal ou vertical, à semelhança do movimento de uma torre no xadrez. Durante o movimento nenhuma peça pode saltar por cima de outra ou ocupar uma casa já ocupada, como ilustrado na figura \ref{fig:moves}.

As capturas são feitas movimentando uma peça para uma casa que lhe seja diagonalmente adjacente e que esteja ocupada por uma peça do adversário, como ilustrado na figura \ref{fig:captures}, sendo esta removida do jogo.

Quando o navio almirante dourado efetua um movimento o jogador dourado não pode efetuar outro movimento nesse turno.

\subsubsection{Objetivo do Jogo}
O jogador prateado ganha o jogo ao capturar o navio almirante dourado. O jogador dourado ganha o jogo se o navio almirante chegar a uma das casas exteriores do tabuleiro.

\begin{figure}
\centering
\includegraphics[scale=1]{Breakthru_board.png}
\centering
\caption{Uma posição inicial possível das peças num tabuleiro de Breakthru}
\label{fig:init}
\end{figure}
\begin{figure}
\centering
\includegraphics[scale=1]{Breakthru_moves.png}
\caption{A vermelho: movimentos possíveis da peça dourada}
\label{fig:captures}
\end{figure}

\begin{figure}
\centering
\includegraphics[scale=1]{Breakthru_capture.png}
\caption{A vermelho: capturas possíveis da peça dourada}
\label{fig:moves}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Representação do Estado do Jogo}
O tabuleiro é representado como uma lista de listas. De seguida apresentam-se  exemplos de tabuleiros iniciais, intermédios e finais criados em Prolog.

Possível estado inicial:

\begin{verbatim}
[[' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ',' ','p','p','p','p','p',' ',' ',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ','p',' ',' ','d','d','d',' ',' ','p',' '],
 [' ','p',' ','d',' ',' ',' ','d',' ','p',' '],
 [' ','p',' ','d',' ','F',' ','d',' ','p',' '],
 [' ','p',' ','d',' ',' ',' ','d',' ','p',' '],
 [' ','p',' ',' ','d','d','d',' ',' ','p',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ','p','p','p','p','p','p',' ',' ',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '] ]
\end{verbatim}

Possível estado intermédio:
\begin{verbatim}
[[' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ',' ','p','p',' ','d','p',' ',' ',' '],
 [' ',' ',' ','d',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ',' ','p','d',' ','d','p',' ',' ',' '],
 [' ','p',' ',' ',' ','p',' ','d',' ','p',' '],
 [' ','p',' ','d',' ','F',' ','d',' ','p',' '],
 [' ','p',' ','d',' ',' ',' ','d',' ','p',' '],
 [' ','p',' ',' ','d','d','d',' ',' ','p',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ','p','p','p','p','p','p',' ',' ',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '] ]
\end{verbatim}

Possível estado final, onde as peças douradas venceram porque o navio almirante atingiu uma das casas exteriores:
\begin{verbatim}
[[' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ',' ','p','p',' ','d','p',' ',' ',' '],
 [' ',' ',' ','d',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ',' ','p','d',' ','d','p',' ',' ',' '],
 [' ','p',' ',' ',' ','p',' ','d',' ','p',' '],
 [' ','p',' ','d',' ',' ',' ',' ','d','p',' '],
 [' ','p',' ','d',' ',' ',' ','d',' ','p',' '],
 [' ','p',' ','p','d',' ','d',' ',' ','p',' '],
 [' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '],
 [' ',' ','p','','d',' ','p','p',' ',' ',' '],
 [' ',' ',' ',' ',' ','F',' ',' ',' ',' ',' '] ]
\end{verbatim}


%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Visualização do Tabuleiro}

Foram desenvolvidos alguns predicados em Prolog para permitir a visualização do tabuleiro usando caracteres \textit{ASCII}, como exemplificado pela figura \ref{fig:example}.
\begin{figure}
\centering
\includegraphics[scale=1]{Breakthru_initial_sicstus.png}
\caption{Tabuleiro inicial de um jogo de Breakthru}
\label{fig:example}
\end{figure}

\subsection{Predicados de Visualização}
Foram implementados os predicados de visualização que se seguem:

\begin{verbatim}
printBoard([]):-write('----------------------------------------------').
printBoard([H|T]):-
  write('---------------------------------------------'),nl,
  printLine(H, '|'), nl,
  printBoard(T).

printLine([], Sep):-
  write(Sep).
printLine([H|T], Sep):-
  write(Sep),write(' '), write(H), write(' '),
  printLine(T, Sep).
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Movimentos}
São possíveis movimentos simples ou capturas, para os quais se desenvolverão os predicados cujos cabeçalhos se elencam na secção \ref{sec:predicates}, que devem suceder somente se o movimento for legal ou for possível efetuar a captura, respetivamente.

\subsection{Cabeçalhos dos Predicados} \label{sec:predicates}
\begin{verbatim}
movePiece(RowOrigin, ColumnOrigin, RowDestiny, ColumnDestiny,
 Player, Board, NewBoard):-

capturePiece(RowOrigin, ColumnOrigin, RowDestiny, ColumnDestiny,
 Player, Board, NewBoard):-
\end{verbatim}

\section{Conclusão}
Ficaram, no entender do grupo, fortemente evidenciadas as vantagens situacionais do uso do paradigma em causa para abordar a classe de problemas que frequentemente surgem no desenvolvimento de simuladores de jogos de tabuleiros. Com efeito, o trabalho desenvolvido evidencia que, recorrendo a capacidades que são exclusivas da programação em lógica, se torna possível exprimir de forma sucinta funcionalidades de um programa que se revelariam de elevada complexidade, do ponto de vista da implementação. O PROLOG permite em larga medida que o programador prescinda da necessidade de especificar um modelo de execução, o que constitui, regra geral, o maior desafio para a implementação deste tipo de programas.

O trabalho apresenta como principal limitação o facto de a inteligência artificial implementada para o segundo nível de dificuldade não apresentar uma função de avaliação do tabuleiro plenamente desenvolvida. A lógica de avaliação implementada é essencialmente binária: a máquina procura a cada passo garantir somente que não vai perder no passo seguinte e que captura ao adversário o máximo de peças possíveis, sendo que os restantes movimentos são selecionados, à falta de heurística desenvolvida, de uma forma aleatória. Considerou-se o desenvolvimento de tal função de avaliação e do seu uso num algoritmo \textit{Minimax}, mas limitações ao nível do tempo e da compreensão plena deste algoritmo, que não foi extensivamente abordado nas aulas da Unidade Curricular, não no-lo permitiram.


\end{document}
